function t(t,e){const n=t.match(new RegExp(`.*(?=${e})`));return null===n?"":n.join("")}function e(t,e){const n=t.match(new RegExp(`[^${e}]+$`));return null===n?"":n[0]}function n(t){const e=t.match(/\d+(?!.*\d)/g);return null===e?"":e[0]}function i(t){console.warn("Can’t parse the file sequence correctly, returning [].\nReason: "+t)}
/**
 * Sequencer - A fast(?) fullscreen image-sequence player.
 * See README or visit github (link below) for details.
 * @copyright 2012-21
 * @version 3.0.1
 * @author Andreas Gysin
 *         https://ertdfgcvb.xyz
 *         https://github.com/ertdfgcvb/Sequencer
 */const o=[],s={hasTouch:!1};class c{constructor(o){if(this.config={canvas:null,list:[],from:"",to:"",step:1,scaleMode:"cover",direction:"x",playMode:"drag",loop:"loop",interval:0,autoLoad:"all",fitFirstImage:!1,showLoadedImages:!1,dragAmount:10,hiDPI:!0,smoothing:!0,...o},""==this.config.from&&""==this.config.to&&0==this.config.list.length)return console.error("Missing filenames."),!1;if(null===this.config.canvas){const t=document.createElement("canvas");document.body.appendChild(t),this.config.canvas=t,this.config.fitFirstImage=!0}this.pointer={x:0,y:0,down:!1},this.current=-1,this.images=[],this.directionSign=/-/.test(this.config.direction)?-1:1,this.lastLoaded=-1,this.pongSign=1,this.ctx=this.config.canvas.getContext("2d"),this.list=this.config.list.length>0?this.config.list:function(o,s,c=1){const a=[],h=n(o);if(""===h)return i("the first filename doesn’t contain a number."),a;const r=n(s);if(""===r)return i("the last filename doesn’t contain a number."),a;const g=t(o,h),f=e(o,h);if(g!==t(s,r)||f!==e(s,r))return i("the base-names of '"+o+"' and '"+s+"' don’t match."),a;if((0==h.charAt(0)||0==r.charAt(0))&&h.length!=r.length)return i("wrong number of leading zeros."),a;const u=parseInt(h),l=parseInt(r);for(let t=u;t<=l;t+=c)a.push(g+(t+"").padStart(h.length,"0")+f);return a}(this.config.from,this.config.to,this.config.step),this.size(this.ctx.canvas.width,this.ctx.canvas.height),"first"==this.config.autoLoad?new l(this.images,[this.list.shift()],a.bind(null,this)):"all"==this.config.autoLoad&&this.load()}load(){this.load=function(){console.log("load() can be called only once.")},new l(this.images,this.list,a.bind(null,this),h.bind(null,this))}run(){const t=s.hasTouch?"touchmove":"mousemove",e=s.hasTouch?"touchstart":"mousedown",n=s.hasTouch?"touchend":"mouseup";if("hover"===this.config.playMode)this.ctx.canvas.addEventListener(t,u.bind(null,this));else if("drag"===this.config.playMode)this.ctx.canvas.addEventListener(t,f.bind(null,this)),this.ctx.canvas.addEventListener(e,r.bind(null,this)),document.addEventListener(n,g.bind(null,this));else if("auto"===this.config.playMode){let t=0;const e=n=>{const i=n-t;i>=this.config.interval&&(this.nextImage(),t=Math.max(n,n-(i-this.config.interval))),requestAnimationFrame(e)};requestAnimationFrame(e)}}nextImage(t){t||(t=this.config.loop),"pong"===t?(this.current+=this.pongSign,this.current>=this.images.length-1?(this.pongSign=-1,this.current=this.images.length-1):this.current<=0&&(this.pongSign=1,this.current=0),this.drawImage(this.current)):this.drawImage(++this.current%this.images.length)}drawImage(t){if(void 0===t&&(t=this.current),t<0||t>=this.images.length)return;const e=this.ctx.canvas.width/1,n=this.ctx.canvas.height/1,i=e/n,o=this.images[t],s=o.width/o.height;let c,a;"cover"==this.config.scaleMode?i>s?(c=e,a=c/s):(a=n,c=a*s):"contain"==this.config.scaleMode?i<s?(c=e,a=c/s):(a=n,c=a*s):(c=o.width,a=o.height);const h=e/2-c/2,r=n/2-a/2;this.ctx.save(),this.ctx.scale(1,1),this.ctx.clearRect(0,0,e,n),this.ctx.imageSmoothingEnabled=this.config.smoothing,this.ctx.drawImage(o,0,0,o.width,o.height,Math.floor(h),Math.floor(r),Math.ceil(c),Math.ceil(a)),this.ctx.restore()}size(t,e){const n=this.ctx.canvas;n.width=1*t,n.height=1*e,n.style.width=t+"px",n.style.height=e+"px",this.drawImage()}}function a(t,e){e.id>t.lastLoaded&&t.config.showLoadedImages&&(t.drawImage(e.id),t.lastLoaded=e.id),"function"==typeof t.config.imageLoad&&(e.sequencer=t,t.config.imageLoad(e)),"function"==typeof t.imageLoad&&(e.sequencer=t,t.imageLoad(e)),0===e.id&&(t.config.fitFirstImage&&(t.size(e.img.width,e.img.height),t.config.fitFirstImage=!1),t.drawImage(0),t.current=0)}function h(t,e){"function"==typeof t.config.queueComplete&&(e.sequencer=t,t.config.queueComplete(e)),"function"==typeof t.queueComplete&&t.queueComplete(e),t.run(),t.config.showLoadedImages||"none"===t.config.playMode||t.drawImage(0)}function r(t,e){let n,i;e.touches?(n=e.touches[0].pageX-e.touches[0].target.offsetLeft,i=e.touches[0].pageY-e.touches[0].target.offsetTop):(n=e.offsetX,i=e.offsetY),t.pointer={x:n,y:i,down:!0,currentId:t.current}}function g(t,e){t.pointer.down=!1}function f(t,e){if(!t.pointer.down)return;const n=t.images.length;let i,o;e.touches?(i=e.touches[0].pageX-e.touches[0].target.offsetLeft,o=e.touches[0].pageY-e.touches[0].target.offsetTop):(i=e.offsetX,o=e.offsetY);let s=0;/x/.test(t.config.direction)?s=(i-t.pointer.x)*t.directionSign:/y/.test(t.config.direction)&&(s=(o-t.pointer.y)*t.directionSign);let c=t.pointer.currentId+Math.floor(s/t.config.dragAmount);c<0?c=n- -c%n:c>n&&(c%=n),c!=t.current&&(t.drawImage(c),t.current=c),e.preventDefault()}function u(t,e){const n=t.images.length;let i,o,s,c;e.touches?(i=e.touches[0].pageX-e.touches[0].target.offsetLeft,o=e.touches[0].pageY-e.touches[0].target.offsetTop):(i=e.offsetX,o=e.offsetY),"x"==t.config.direction?(c=t.ctx.canvas.width/1,s=i):"-x"==t.config.direction?(c=t.ctx.canvas.width/1,s=c-i-1):"y"==t.config.direction?(c=t.ctx.canvas.height/1,s=o):"-y"==t.config.direction&&(c=t.ctx.canvas.height/1,s=c-o-1);const a=(h=Math.floor(s/c*n),g=n-1,h<(r=0)?r:h>g?g:h);var h,r,g;a!=t.current&&(t.drawImage(a),t.current=a),e.preventDefault()}function l(t,e,n,i){const o=Math.min(e.length,4);let s=t.length-1,c=t.length;for(let t=0;t<o;t++)a();function a(){if(s>=e.length-1)return;s++;const o=new Image;var h;o.src=e[s],h=s,o.onload=t=>{"function"==typeof n&&n({id:h,img:o,count:++c,total:e.length}),c<e.length&&a(),c==e.length&&"function"==typeof i&&i({total:e.length})},o.onerror=t=>{console.error("Error with: "+e[h])},t.push(o)}}var d={make:function(t,e){s.hasTouch="ontouchstart"in e||navigator.msMaxTouchPoints;const n=new c(t);return!1!==n&&o.push(n),n},instances:o};export{d as default};
